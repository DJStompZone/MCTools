@page "/assets"
@using MCTools.Models
@using MCTools.Enums
@using MCTools.Controllers
@using MCTools.Logic

@inherits LayoutComponentBase
@inject ISnackbar Snackbar
@inject ApiController _apiController
@inject HttpClient _httpClient
@inject JSHelper _jsHelper

<MudText Typo="Typo.h3" GutterBottom="true">Asset Download</MudText>

<MudPaper Class="px-8">
	<MudGrid Justify="Justify.Center">
		<MudItem xs="6">
			<MudSelect T="MCEdition" Label="Edition" Variant="Variant.Outlined" Margin="Margin.Dense" AnchorOrigin="Origin.BottomCenter" Disabled="IsProcessing"
					   SelectedValues="new List<MCEdition>() { SelectedEdition }" SelectedValuesChanged="(e) => SelectedEditionChanged(e.First())">
				<MudSelectItem Value="MCEdition.Java">Java</MudSelectItem>
				<MudSelectItem Value="MCEdition.Bedrock" Disabled="true">Bedrock</MudSelectItem>
			</MudSelect>
		</MudItem>
		<MudItem xs="6">
			<MudSelect T="MCVersion" Label="Version" Variant="Variant.Outlined" Margin="Margin.Dense" AnchorOrigin="Origin.BottomCenter" Disabled="IsProcessing"
			           SelectedValues="new List<MCVersion>() { SelectedVersion }" SelectedValuesChanged="(e) => SelectedVersion = e.First()">
				@foreach (MCVersion ver in MinecraftVersions)
				{
					string val = $"{ver.Id}{ver.GetSuffix(LatestVersion)}";
					<MudSelectItem Value="ver">@val</MudSelectItem>
				}
			</MudSelect>
		</MudItem>
		@if (MainLayout.DebugMode)
		{
			<MudItem xs="12" Class="pa-2 my-1">
				<MudText Typo="Typo.h6" GutterBottom="true">Debug</MudText>
				<MudGrid Justify="Justify.SpaceAround" Spacing="2" >
					<MudList>
						<MudItem Class="my-1">
							<MudSwitch @bind-Checked="PerfLogging" Label="Performance Logging" Color="Color.Primary" Disabled="IsProcessing" />
						</MudItem>
					</MudList>
				</MudGrid>
			</MudItem>
		}
		<MudItem xs="12">
			@if (IsProcessing)
			{
				<MudProgressLinear Color="Color.Primary" Size="Size.Small" Indeterminate="true" Class="my-7" />
			}
			else
			{
				<MudProgressLinear Color="Color.Primary" Size="Size.Small" Value="0" Max="100" Class="my-7" />
			}
			<MudButton HtmlTag="label"
			           Variant="Variant.Filled"
			           Color="Color.Primary"
			           StartIcon="@Icons.Material.Filled.CloudDownload"
			           style="width: 100%;"
			           Disabled="IsProcessing"
			           OnClick="@DownloadAssets">
				Download Texture Assets
			</MudButton>
		</MudItem>
	</MudGrid>
</MudPaper>